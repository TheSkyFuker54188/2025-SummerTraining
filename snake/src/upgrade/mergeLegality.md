
我来进行第二批优化，压缩illegalMove函数中的重复逻辑。
第二批优化已完成。我简化了 `illegalMove`函数中的重复代码，主要变化包括：

1. 添加了 `checkDirectionLegality`辅助函数，将方向合法性检查逻辑集中到一处
2. 该函数接受方向和是否为紧急模式作为参数，返回布尔值表示该方向是否合法
3. 两个几乎相同的for循环被简化，统一调用辅助函数进行检查
4. 条件判断逻辑更加清晰，使用返回值而非直接修改集合

这次优化减少了代码重复，提高了可读性和可维护性。原先的两个大型for循环现在被简化为两个简洁的循环，而详细的检查逻辑被封装在辅助函数中。

下一批优化可以继续压缩哪部分代码？
